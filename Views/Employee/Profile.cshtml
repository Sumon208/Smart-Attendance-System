@model Smart_Attendance_System.Models.Employee

@{
    ViewData["Title"] = "Employee Profile";
    Layout = "_EmployeeLayout";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-user text-primary"></i> Employee Profile</h2>
    <div>
        <button class="btn btn-primary" onclick="editProfile()">
            <i class="fas fa-edit mr-2"></i>Edit Profile
        </button>
    </div>
</div>

<!-- Profile Header -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card border-0 shadow-sm">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-md-3 text-center">
                        <img src="@(Model?.EmployeePhotoPath ?? "/images/default_user.jpg")" 
                             alt="Profile Photo" 
                             class="rounded-circle profile-photo mb-3" />
                        <div>
                            <span class="badge badge-@(Model?.Status == EmployeeStatus.Approved ? "success" : "warning")">
                                @(Model?.Status ?? EmployeeStatus.Pending)
                            </span>
                        </div>
                    </div>
                    <div class="col-md-9">
                        <h3 class="mb-2">@(Model?.EmployeeName ?? "Employee Name")</h3>
                        <p class="text-muted mb-2">
                            <i class="fas fa-id-badge mr-2"></i>
                            Employee ID: @(Model?.EmployeeId ?? "N/A")
                        </p>
                        <p class="text-muted mb-2">
                            <i class="fas fa-building mr-2"></i>
                            Department: @(Model?.Department?.DepartmentName ?? "N/A")
                        </p>
                        <p class="text-muted mb-2">
                            <i class="fas fa-calendar-alt mr-2"></i>
                            Joined: @(Model?.DateOfBirth?.ToString("MMMM yyyy") ?? "N/A")
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Profile Information -->
<div class="row">
    <div class="col-md-8">
        <div class="card card-custom mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-info-circle mr-2"></i>Personal Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Full Name</label>
                            <p class="form-control-plaintext">@(Model?.EmployeeName ?? "N/A")</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Employee ID</label>
                            <p class="form-control-plaintext">@(Model?.EmployeeId ?? "N/A")</p>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Date of Birth</label>
                            <p class="form-control-plaintext">@(Model?.DateOfBirth?.ToString("MMMM dd, yyyy") ?? "N/A")</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Gender</label>
                            <p class="form-control-plaintext">@(Model?.Gender ?? "N/A")</p>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Nationality</label>
                            <p class="form-control-plaintext">@(Model?.Nationality ?? "N/A")</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Blood Group</label>
                            <p class="form-control-plaintext">@(Model?.BloodGroup ?? "N/A")</p>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Mobile Number</label>
                            <p class="form-control-plaintext">@(Model?.MobileNumber ?? "N/A")</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Email</label>
                            <p class="form-control-plaintext">@User.Identity?.Name</p>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label font-weight-bold">Description</label>
                    <p class="form-control-plaintext">@(Model?.Description ?? "No description available")</p>
                </div>
            </div>
        </div>

        <!-- Employment Information -->
        <div class="card card-custom mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-briefcase mr-2"></i>Employment Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Department</label>
                            <p class="form-control-plaintext">@(Model?.Department?.DepartmentName ?? "N/A")</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Salary</label>
                            <p class="form-control-plaintext">@(Model?.Salary?.ToString("C") ?? "N/A")</p>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Employment Status</label>
                            <p class="form-control-plaintext">
                                <span class="badge badge-@(Model?.Status == EmployeeStatus.Approved ? "success" : "warning")">
                                    @(Model?.Status ?? EmployeeStatus.Pending)
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label font-weight-bold">Employee Since</label>
                            <p class="form-control-plaintext">@(Model?.DateOfBirth?.ToString("MMMM yyyy") ?? "N/A")</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <!-- Quick Stats -->
        <div class="card card-custom mb-3">
            <div class="card-header bg-success text-white">
                <h6 class="mb-0"><i class="fas fa-chart-pie mr-2"></i>Quick Stats</h6>
            </div>
            <div class="card-body">
                <div class="text-center mb-3">
                    <h4 class="text-success">95%</h4>
                    <small class="text-muted">Attendance Rate</small>
                </div>
                <div class="text-center mb-3">
                    <h4 class="text-info">15</h4>
                    <small class="text-muted">Leave Days Used</small>
                </div>
                <div class="text-center mb-3">
                    <h4 class="text-warning">2</h4>
                    <small class="text-muted">Late Arrivals</small>
                </div>
                <div class="text-center">
                    <h4 class="text-primary">8.5</h4>
                    <small class="text-muted">Avg. Working Hours</small>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="card card-custom mb-3">
            <div class="card-header bg-warning text-dark">
                <h6 class="mb-0"><i class="fas fa-bolt mr-2"></i>Quick Actions</h6>
            </div>
            <div class="card-body">
                <a asp-controller="Attendance" asp-action="Attendance" class="btn btn-outline-primary btn-block mb-2">
                    <i class="fas fa-clock mr-2"></i>Mark Attendance
                </a>
                <a asp-controller="Leave" asp-action="LeaveApply" class="btn btn-outline-info btn-block mb-2">
                    <i class="fas fa-calendar-plus mr-2"></i>Apply for Leave
                </a>
                <a asp-controller="Attendance" asp-action="AttendanceHistory" class="btn btn-outline-success btn-block mb-2">
                    <i class="fas fa-chart-bar mr-2"></i> View History
                </a>

                <button class="btn btn-outline-warning btn-block" onclick="changePassword()">
                    <i class="fas fa-key mr-2"></i>Change Password
                </button>
            </div>
        </div>

        <!-- Contact Information -->
        <div class="card card-custom">
            <div class="card-header bg-secondary text-white">
                <h6 class="mb-0"><i class="fas fa-address-book mr-2"></i>Contact Info</h6>
            </div>
            <div class="card-body">
                <p class="mb-2">
                    <i class="fas fa-envelope text-primary mr-2"></i>
                    <small>@User.Identity?.Name</small>
                </p>
                <p class="mb-2">
                    <i class="fas fa-phone text-success mr-2"></i>
                    <small>@(Model?.MobileNumber ?? "N/A")</small>
                </p>
                <p class="mb-0">
                    <i class="fas fa-map-marker-alt text-danger mr-2"></i>
                    <small>Office Location</small>
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Edit Profile Modal -->
<div class="modal fade" id="editProfileModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title"><i class="fas fa-edit mr-2"></i>Edit Profile</h5>
                <button type="button" class="close text-white" data-dismiss="modal">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="editProfileForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Full Name</label>
                                <input type="text" class="form-control" value="@(Model?.EmployeeName ?? "")" />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Mobile Number</label>
                                <input type="tel" class="form-control" value="@(Model?.MobileNumber ?? "")" />
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Date of Birth</label>
                                <input type="date" class="form-control" value="@(Model?.DateOfBirth?.ToString("yyyy-MM-dd") ?? "")" />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Blood Group</label>
                                <select class="form-control">
                                    <option value="">Select Blood Group</option>
                                    <option value="A+">A+</option>
                                    <option value="A-">A-</option>
                                    <option value="B+">B+</option>
                                    <option value="B-">B-</option>
                                    <option value="AB+">AB+</option>
                                    <option value="AB-">AB-</option>
                                    <option value="O+">O+</option>
                                    <option value="O-">O-</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Description</label>
                        <textarea class="form-control" rows="3">@(Model?.Description ?? "")</textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveProfile()">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<style>
    .profile-photo {
        width: 150px;
        height: 150px;
        object-fit: cover;
        border: 4px solid #fff;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .card-custom {
        border: none;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .form-control-plaintext {
        padding: 0.375rem 0;
        margin-bottom: 0;
        color: #495057;
        background-color: transparent;
        border: solid transparent;
        border-width: 1px 0;
    }
    
    .badge {
        font-size: 0.8rem;
        padding: 0.4rem 0.6rem;
    }
</style>

<script>
    function editProfile() {
        $('#editProfileModal').modal('show');
    }
    
    function saveProfile() {
        // TODO: Implement profile update functionality
        alert('Profile update functionality will be implemented.');
        $('#editProfileModal').modal('hide');
    }
    
    function changePassword() {
        // TODO: Implement password change functionality
        alert('Password change functionality will be implemented.');
    } 
</script>
